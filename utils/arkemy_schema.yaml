# ARKEMY Schema Configuration
# This schema defines record types, fields, and validation rules for time tracking data
# Edit this file to modify data requirements without changing code

schema_version: "2.0"
description: "Unified schema for time tracking and planned hours data"

# Core configuration
settings:
  record_type_column: "record_type"
  default_record_type: "time_record"
  date_column: "record_date"
  required_id_fields: ["record_id", "person_name", "project_number"]

# Define record types and their specific requirements
record_types:
  time_record:
    description: "Actual time tracking entries"
    display_name: "Time Records"
    required_fields:
      - record_date
      - person_name
      - project_number
      - hours_used
    optional_fields:
      - record_desc
      - person_type
      - person_role
      - hours_billable
      - hours_non_billable
      - billable_rate_record
      - billable_rate_adjust
      - project_name
      - customer_name
      - cost_hour
      - cost_record
      - fee_record
      - profit_hour
      - profit_record
    session_state_target: "transformed_df"

  planned_record:
    description: "Planned/forecast hours entries"
    display_name: "Planned Hours"
    required_fields:
      - record_date
      - person_name
      - project_number
    optional_fields:
      - project_name
      - customer_name
      - planned_hours
      - planned_rate
      - planned_income
    session_state_target: "transformed_planned_df"

# Field definitions with types and validation rules
fields:
  # Core identifiers
  record_id:
    type: string
    description: "Unique identifier for each record"

  record_type:
    type: string
    description: "Type of record (time_record, planned_record, etc.)"
    required: true

  record_date:
    type: datetime
    description: "Date in YYYY-MM-DD format"
    required: true

  record_desc:
    type: string
    description: "Description or notes for the entry"

  # Person information
  person_id:
    type: string
    description: "System ID of the person"

  person_name:
    type: string
    description: "Name of the person who logged time"
    required: true

  person_type:
    type: string
    description: "Internal or External"

  person_role:
    type: string
    description: "Person's role on the project"

  # Time tracking fields
  hours_used:
    type: float
    description: "Total time logged in hours"
    min_value: 0

  hours_billable:
    type: float
    description: "Billable hours"
    min_value: 0

  hours_non_billable:
    type: float
    description: "Non-billable hours"
    min_value: 0

  # Financial fields
  billable_rate_record:
    type: float
    description: "Billable rate from time record"
    min_value: 0

  billable_rate_adjust:
    type: float
    description: "Adjusted billable rate"
    min_value: 0

  cost_hour:
    type: float
    description: "Cost per hour"
    min_value: 0

  cost_record:
    type: float
    description: "Total cost for the record"

  fee_record:
    type: float
    description: "Total fee for the record"

  profit_hour:
    type: float
    description: "Profit per hour"

  profit_record:
    type: float
    description: "Total profit for the record"

  # Planned fields
  planned_hours:
    type: float
    description: "Planned time in hours"
    min_value: 0

  planned_rate:
    type: float
    description: "Planned hourly rate"
    min_value: 0

  planned_income:
    type: float
    description: "Total planned income"
    min_value: 0

  # Project information
  project_id:
    type: string
    description: "System ID of the project"

  project_number:
    type: string
    description: "Project identifier/code"
    required: true

  project_name:
    type: string
    description: "Name of the project"

  # Customer information
  customer_id:
    type: string
    description: "System ID of customer"

  customer_number:
    type: string
    description: "Customer identifier/code"

  customer_name:
    type: string
    description: "Client/customer name"

  # Project context
  activity_name:
    type: string
    description: "Project phase/activity"

  price_model_type:
    type: string
    description: "Pricing model type"

  price_model_name:
    type: string
    description: "Name of pricing model"

  # Tag fields
  phase_tag:
    type: string
    description: "Project phase tags"

  person_tag:
    type: string
    description: "Person-related tags"

  project_tags:
    type: string
    description: "Project-related tags"

  customer_tags:
    type: string
    description: "Customer-related tags"

  timeRecord_tags:
    type: string
    description: "Time record specific tags"

  # System metadata
  company_name:
    type: string
    description: "Name of the company"

  company_code:
    type: string
    description: "Company identifier"

  extraction_date:
    type: datetime
    description: "Date when data was extracted"

  source_system:
    type: string
    description: "Source time tracking system"

# Type mapping for pandas
pandas_type_mapping:
  string: "string"
  integer: "Int64"
  float: "float64"
  datetime: "datetime64[ns]"
  boolean: "boolean"

# Validation settings
validation:
  strict_mode: false
  allow_unknown_fields: true
  show_field_descriptions: true
  max_validation_errors: 10